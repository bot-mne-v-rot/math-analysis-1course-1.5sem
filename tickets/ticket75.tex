\section{Многомерный Тейлор с остатком в форме Пеано. Полиномиальная формула.}

\follow \; (Многомерный Тейлор с остатком в форме Пеано) 

Пусть $f \in C^r(D), D$ -- открыто, $a \in D$. Тогда при $x \longrightarrow a$: 
\begin{gather*}
    f(x) = \sum_{\abs{k} \leqslant r} \frac{f^{(k)}(a)}{k!} (x-a)^k + o(\norm{x-a}^r)
\end{gather*}
\notice \; На самом деле для формулы достаточно $r$-ой дифференцируемости в точке $a$
\begin{proof}
    Запишем многомерную формулу Тейлора с остатком по Лагранжу для $f \in C^r(D)$ (т.е. мы уменьшаем $r$ на 1 по сравнению с классической формулой):
    \begin{gather*}
        f(x) = \sum_{\abs{k} \leqslant r - 1} \frac{f^{(k)}(a)}{k!} (x-a)^k + \sum_{\abs{k} = r} \frac{f^{(k)}(a+\Theta(x-a))}{k!}(x-a)^k
    \end{gather*}
    Увеличим границу суммирования в первой сумме и отнимем, что прибавилось, во второй:
    \begin{gather*}
        f(x) = \sum_{\abs{k} \leqslant r} \frac{f^{(k)}(a)}{k!} (x-a)^k + \underbrace{\sum_{\abs{k} = r} \left[ \frac{f^{(k)}(a+\Theta(x-a))}{k!}(x-a)^k - \frac{f^{(k)}(a)}{k!}(x-a)^k\right]}_{\heartsuit}
    \end{gather*}
Хотим понять, что $\heartsuit = o(\norm{x-a}^r)$. Для удобства пусть $h = x - a$. 
\begin{gather*}
    \heartsuit = \sum\limits_{\abs{k} = r} \frac{h^k}{k!} \left( f^{(k)} (a + \Theta(x - a)) - f^{(k)}(a) \right)
\end{gather*} 
Мысль первая: 
\begin{gather*}
    \abs{h^k} \leqslant \norm{h}^r
\end{gather*}
Давайте осознаем, почему это правда. Что такое $h^k$? 
Это вектор в степени мультииндекса. То есть это мы берем 
первую координату вектора, возводим в степень $k_1$, потом 
берем другую координату вектора, возводим в степень $k_2$ и так далее. 
Потом мы все это перемножаем. Координат всего $r$ штук, так как $r$ -- высота мультииндекса. 
Модуль каждой координаты не больше, чем длина вектора. 
Поэтому мы перемножили что то меньшее, чем длина вектора в степени $r$. 
Иными словами, $\abs{h^k}$ однозначно не больше $\norm{h}^r$.

Тогда теперь навесим модули на наше равенство, вынесем $\abs{h^k}$ и оценим его сверху как $\norm{h}^r$. Получим следующее неравенство: 
\begin{gather*}
    \abs{\heartsuit} \leqslant \norm{h}^r \sum\limits_{\abs{k} = r} \frac{1}{k!} \abs{ f^{(k)} (a + \Theta(x - a)) - f^{(k)}(a) }
\end{gather*}
Вспомним, что мы хотим доказать, что эта штука -- это $o(\norm{h}^r)$. То есть осталось проверить, что: 
\begin{gather*}
    \sum\limits_{\abs{k} = r} \frac{1}{k!} \abs{ f^{(k)} (a + \Theta(x - a)) - f^{(k)}(a) } \overset{x \rightarrow a}{\longrightarrow} 0
\end{gather*}
Ну а чего тут собственно проверять. Написано конечное количество слагаемых, значит нужно проверить, что каждое из них стремится к 0. 
А это, в свою очередь, легко видеть, так как функция нужное количество раз непрерывно дифференцируема, 
из чего следует, что соответствующая производная, которая тут написана -- непрерывна, ну а значит если аргумент стремится к $a$, 
то и производная стремится к производной в точке $a$. Следовательно при $x \longrightarrow a$, $f^{(k)} (a + \Theta(x - a)) \longrightarrow f^{(k)}(a)$. 
\end{proof}
\follow \; (Полиномиальная формула)
\begin{gather*}
    (x_1 + x_2 + \dots + x_n)^r = \sum\limits_{\abs{k} = r} \binom{r}{k_1, k_2, \dots, k_n} x_1^{k_1} x_2^{k_2} \dots x_n^{k_n}
\end{gather*}
\begin{proof} \quad 

    Пусть $g(x) = g(x_1, x_2, \dots, x_n) = x_1 + x_2 + \dots + x_n$. Тогда: 
    \begin{gather*}
        f(x_1, x_2, \dots, x_n) = (x_1 + x_2 + \dots + x_n)^r = (g(x))^r
    \end{gather*}
    Хотим воспользоваться формулой Тейлора для $f$, значит давайте для начала научимся ее дифференцировать. Поймем, как устроены у нее частные производные. 
    Например следующие: $\frac{df}{dx_j}$. Это производная композиции, так что она будет равна:
    \begin{gather*}
        \frac{df}{dx_j} = r(g(x))^{r-1} \cdot \frac{dg}{dx_j} = r(g(x))^{r-1} \cdot 1 = r(g(x))^{r-1}
    \end{gather*}
    То есть частные производные по всем иксам одинаковые и равны вот такой штуке. 
    Отсюда мы можем сказать, что если у нас высота мультииндекса меньше $r$, 
    то в нуле все эти производные будут равны нулю. $f^{(k)}(0, \dots, 0) = 0$.
    Если же $\abs{k} > r$, то $f^{k} \equiv 0$, а если $\abs{k} = r$, то $f^{k} \equiv r!$.
    Теперь мы можем написать для $f$ формулу Тейлора с остатком в форме Лагранжа так, 
    чтобы остаток был высоты $r+1$. Тогда он занулится, все слагаемые меньшего порядка 
    тоже занулятся, а нам останется только следующее: 
    \begin{align*}
        f(x) &= \sum\limits_{\abs{k} = r} \frac{f^{(k)}(0)}{k!}x^k \\
        &= \sum\limits_{\abs{k} = r} \frac{r!}{k!} x^k \\
        &= \sum\limits_{\abs{k} = r} \binom{r}{k_1, k_2, \dots, k_n} x_1^{k_1} x_2^{k_2} \dots x_n^{k_n}
    \end{align*}
\end{proof}

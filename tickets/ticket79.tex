\section{Теорема об обратной функции.}

Теперь мы готовы сформулировать и доказать главную теорему данного параграфа -- теорему об обратной функции.
Храбров назвал ее самой сложной теоремой курса, так что пристегните ремни.

\underline{Мотивация}

\quad \textit{На данный момент мы знаем условия на то, чтобы линейное отображние было обратимо.
Например, определитель его матрицы не должен быть равен 0. 
Хочется понять, существуют ли такие условия для не линейного, а просто непрерывно дифференерцируемого отображения.
Оказывается, что глобальной обратимости у нас не будет, а вот локальная вполне будет существовать, если отображение будет достаточно хорошим.
Более формально: если у нас в точке дифференциал обратим, то в небольшой окрестности этой точки наше отображение будет вести себя примерно как линейное, а значит будет обратимо.}

\begin{theorem} (об обратной функции) \\
    Пусть
    \begin{itemize}
        \item $f: D \to \R^n$, где $D \subset \R^n$ -- открытое
        \item $x_0 \in D$, причем $f$ непрерывно дифференерцируемо в окр-ти $x_0$; $y_0 = f(x_0)$
        \item линейное отображение $\A = f'(x_0)$ обратимо (дифференциал в точке обратим)
    \end{itemize} 
    Тогда $\exists \, U$ -- окр-ть точки $x_0$, $\exists \, V$ -- окр-ть точки $y_0$, т.ч. $f: U \to V$ обратимо и  $f^{-1}: V \to U$ непрерывно.
\end{theorem}
\begin{proof}
    Введем отображение $G_y(x) := x + \A^{-1}(y - f(x))$.
    Выберем $B_r(x_0)$ так, что $\forall x \in B_r(x_0)$ выполняется $\| \A^{-1} \| * \| \A - f'(x) \| \leqslant \frac{1}{2}$.
    Мы действительно так можем сделать, потому что $\| \A^{-1} \|$ -- это константа, а $f$ непрерывно дифференерцируемо в окр-ти $x_0$, т.е. при $x$ близком к $x_0$ имеем $f'(x)$ близкое к $\A$. 
    Благодаря этому неравенству мы можем применить предыдущую теорему. 
    Получаем, что $f'(x)$ обратимо для $x \in B_r(x_0)$ (честно говоря, я так и не понял, где мы это дальше использовали; если вы это поняли, отредактируйте / напишите кому-то из составителей).

    \quad Теперь мы хотим, чтобы $G_y(x)$ было сжатием. 
    Для этого нам надо понять, что норма ее производной небольшая: \[ \| G_y'(x) \| = \| \underbrace{\mathcal{E}}_{\text{ед. оп.}} + \underbrace{(\A^{-1}(y))'}_{= c' = 0} - \underbrace{(d_{f(x)}\A^{-1} \circ d_xf)}_{\text{опр. диф. комп.}} \| = \| \mathcal{E} - \A^{-1}(f'(x)) \| =\oast \]
    \quad Мы воспользовались тем, что $d_{f(x)}\A^{-1} = \A^{-1}$. 
    Это так, потому что $\A^{-1}$ -- линейное отображение, следовательно, дифференциал, посчитанный в любой точке, равен ему самому.
    Продолжим оценивать норму производной: \[ \oast = \| \A^{-1}(\A - f'(x)) \| \leqslant \| \A^{-1} \| * \|(\A - f'(x)) \| \leqslant \frac{1}{2}  \]
    \quad Значит, $G_y$ -- сжатие с коэффициентом $\frac{1}{2}$. 
    
    \quad Заметим, что для того, чтобы воспользоваться теоремой Банаха
    о сжатии, нам необходимо, чтобы $G_y(B_r(x_0)) \subset B_r(x_0)$.
    Т.е. область значений должна быть не больше области определения.

    \quad Подберем $B_R(y_0)$ так, что $\forall y \in B_R(y_0)$ выполняется $G_y(B_r(x_0)) \subset B_r(x_0)$.
    Оценим, как далеко мы отдаляемся при $y \in B_R(y_0)$:
    \begin{gather*}
        \begin{split}
            \| G_y(x) - x_0 \| &\leqslant  \underbrace{\| G_y(x_0) - x_0 \|}_{= x_0 + \A^{-1}(y-f(x_0)) - x_0} + \| G_y(x) - G_y(x_0) \| \\
            &= \| \A^{-1}(y - y_0)\| + \| G_y(x) - G_y(x_0) \| \\
            &\leqslant \| \A^{-1} \| \| y - y_0 \| + \frac{1}{2}\| x - x_0 \| \leqslant R\| \A^{-1} \| + \frac{r}{2}
        \end{split}
    \end{gather*}
    \quad Мы хотим, чтобы $G_y(x)$ попало в шар $B_r(x_0)$. Tаким образом, должно выполняться \\ $\| G_y(x) - x_0 \| < r$.
    С помощью предыдущего неравенства мы легко подберем нужное $R$ и получим необходимый шар $B_R(y_0)$.

    \quad Теперь воспользуемся теоремой Банаха о сжатии. $G_y$ -- это сжимающее отображение, поэтому обязана существовать неподвижная точка:
    \[ \exists \, x \in B_r(x_0) : x = G_y(x) = x + \A^{-1}(y - f(x)) \Rightarrow \A^{-1}(y - f(x)) = 0 \Rightarrow f(x) = y \]
    \quad Заметим, что такой $x$ будет единственнен, так как если $f(x) = y$, то $x$ -- неподвижная точка, а она всего одна.
    Следовательно, у нас нашлась такая окрестность точки $y_0$, что для каждой точки из нее найдется единственный $x$, т.ч. $f(x) = y$.
    Положим $V := B_R(y_0)$ и $U := f^{-1}(V)$ -- открытая окрестность $x_0$.
    Таким образом: $f: U \to V$ -- биекция $\Rightarrow$ существует $f^{-1}: V \to U$.

    \quad Осталось проверить непрерывность $f^{-1}$.
    Пусть $G_y(x) = x$ и $G_{\widetilde{y}}(\widetilde{x}) = \widetilde{x}$.
    Тогда, как мы поняли, $f(x) = y$ и $f(\widetilde{x}) = \widetilde{y}$.
    Нам нужно оценить норму разности обратного отображения: 
    \begin{gather*}
        \| f^{-1}(y) - f^{-1}(\widetilde{y}) \| = \| x - \widetilde{x} \| \underbrace{\leqslant}_{\text{сл. т. Банаха}} \frac{1}{1 - \frac{1}{2}} \| G_y(x) - G_{\widetilde{y}}(x) \| = \\
        = 2 \| x + \A^{-1}(y - f(x)) - x - \A^{-1}(\widetilde{y} - f(x)) \| = 2 \| \A^{-1}(y - \widetilde{y}) \| \leqslant \\
        \leqslant 2 \| \A^{-1} \| \| y - \widetilde{y} \|
    \end{gather*}
    \quad Это и есть критерий непрерывности.
\end{proof}
